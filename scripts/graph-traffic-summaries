#!/usr/bin/python
#based on an email from Joe
import matplotlib.pyplot as plt
import itertools
from hashlib import sha1
import numpy as np

results = {
    'windows random-seed=1': '''
r\S         1        2        3        4        5        6        7        8        9       10       11       12
  1          0        0        0        0        0        0        0        0        0        0        0        0
  2          0        0        0        0        0        0        0        0        0        0        0        0
  3          0        0        0        0        0        0        0        0        0        0        0        0
  4          0        0        0   41.021   49.025   59.533   72.130   81.616   90.623  101.704  111.728        0
  5          0        0        0   49.977   66.236   79.624   88.913  100.512  113.965  123.569  124.526        0
  6          0        0        0   63.589   76.515   87.228   97.726  111.701  119.851  126.792  123.990        0
  7          0        0        0   73.351   89.297  105.217  122.623  128.813  130.017  130.472  141.562        0
  8          0        0        0   80.995   97.312  114.588  126.114  138.327  138.982  135.945  139.917        0
  9          0        0        0   91.967  121.293  134.624  133.404  137.510  132.918  137.883  137.110        0
 10          0        0        0  116.838  137.009  153.729  146.185  150.077  147.428  149.598  135.035        0
 11          0        0        0  110.442  126.903  128.784  129.947  125.729  133.177  129.456  136.077        0
 12          0        0        0  134.211  152.293  155.384  151.939  158.866  147.375  146.667  147.488        0
 13          0        0        0  149.553  158.250  152.810  148.803  152.967  140.153  143.023  139.778        0
 14          0        0        0  134.262  140.493  139.278  150.710  135.962  149.449  147.272  144.938        0
 15          0        0        0  149.164  163.145  160.715  163.262  151.147  155.794  150.035  138.729        0
 16          0        0        0  172.646  184.950  175.230  188.854  174.901  170.617  168.103  157.606        0
 17          0        0        0  186.454  191.645  195.912  186.668  183.410  182.007  166.788  150.965        0
 18          0        0        0  161.861  163.907  154.566  142.165  153.806  151.287  131.039  124.793        0
 19          0        0        0  174.642  172.648  173.979  171.768  180.598  152.663  140.959  135.018        0
 20          0        0        0  179.880  177.737  192.894  176.140  167.182  139.041  127.832  118.647        0
 21          0        0        0  171.999  169.162  165.517  187.507  168.799  147.176  139.674  112.959        0
 22          0        0        0  175.908  179.072  180.600  188.583  174.674  140.972  120.873  107.009        0
 23          0        0        0  181.788  185.461  167.191  160.740  146.621  126.084  118.479  117.707        0
 24          0        0        0  186.040  207.281  195.752  204.784  173.588  156.044  157.527  135.186        0
 25          0        0        0        0        0        0        0        0        0        0        0        0
    ''',

    'master random-seed=1 v2': '''
 r\S         1        2        3        4        5        6       7        8        9       10       11       12
  1          0        0        0        0        0        0       0        0        0        0        0        0
  2          0        0        0        0        0        0       0        0        0        0        0        0
  3          0        0        0        0        0        0       0        0        0        0        0        0
  4          0        0        0   30.962   35.898   44.241   52.510  58.360   64.431   71.126   76.913        0
  5          0        0        0   32.139   43.242   52.783   58.419  65.574   76.657   82.238   85.825        0
  6          0        0        0   44.503   54.113   59.547   64.061  75.048   82.044   82.443   88.682        0
  7          0        0        0   48.980   58.347   66.445   77.112  80.389   84.988   87.514   92.294        0
  8          0        0        0   52.966   61.329   70.626   80.470  91.707   94.114   93.333   93.081        0
  9          0        0        0   55.854   76.077   82.688   89.644  87.787   91.795   89.386   93.713        0
 10          0        0        0   75.210   86.535   97.310  103.031 101.958  103.712  103.051   93.819        0
 11          0        0        0   67.405   73.655   81.257   79.396  82.722   84.370   83.599   91.403        0
 12          0        0        0   82.207   93.789  101.584  101.107 108.567  103.464  101.119  105.865        0
 13          0        0        0   87.286  101.073   93.215   97.463  97.677   97.014   98.100   86.627        0
 14          0        0        0   75.604   84.917   88.865   94.108  89.063   95.692   78.489   63.202        0
 15          0        0        0   88.087   95.365  101.379  109.875  94.955  109.465  105.526   96.125        0
 16          0        0        0  110.168  121.087  122.063  127.527 126.807   97.004  118.453   86.083        0
 17          0        0        0  124.326  143.394  144.950  147.086 140.541  140.191  131.140  132.923        0
 18          0        0        0   97.742  102.855  104.980  105.631 101.875  108.222   72.967  111.060        0
 19          0        0        0  111.977  116.843  120.077  122.628 122.602   86.203   63.105  100.035        0
 20          0        0        0  110.300  111.566  122.139  112.077  73.161   73.811   82.510   85.269        0
 21          0        0        0  103.800  116.773  117.619  118.919 131.797   90.936  133.795  129.360        0
 22          0        0        0  113.232  124.916  124.845  121.874  91.766  120.737   90.557  113.352        0
 23          0        0        0  126.107  124.788  122.270  134.066 116.764  124.920  127.842  131.663        0
 24          0        0        0  133.894  126.255  126.306  117.240 138.935  130.271   98.415  124.505        0
 25          0        0        0        0        0        0           0        0        0        0        0        0''',

'master random-seed=1 v1': '''
>  r\S         1        2        3        4        5        6        7        8        9       10       11       12
>   1          0        0        0        0        0        0        0        0        0        0        0        0
>   2          0        0        0        0        0        0        0        0        0        0        0        0
>   3          0        0        0        0        0        0        0        0        0        0        0        0
>   4          0        0        0   41.358   48.834   59.542   51.583   58.686   64.417   70.034   76.711        0
>   5          0        0        0   50.612   64.792   69.457   57.163   65.264   76.055   84.067   85.886        0
>   6          0        0        0   62.934   74.668   82.118   66.399   75.752   81.379   83.638   86.841        0
>   7          0        0        0   72.779   74.610   91.751   76.741   83.310   84.621   88.089   90.726        0
>   8          0        0        0   72.120   81.370   82.151   80.163   94.050   96.564   95.995   93.277        0
>   9          0        0        0   74.680   94.877   93.226   88.637   92.555   91.698   94.391   90.510        0
>  10          0        0        0   99.760  108.797  110.777  107.175  102.048  106.963  102.623  101.403        0
>  11          0        0        0   88.686   98.104   89.587   81.619   84.531   84.322   93.366   91.569        0
>  12          0        0        0   96.649  103.722  108.549  102.260  112.032  109.859  102.319  105.791        0
>  13          0        0        0  102.963  117.725  102.504   99.439   97.579   97.534   97.869   83.647        0
>  14          0        0        0   88.767   94.554   95.802   96.295   95.299   98.378   93.943  108.365        0
>  15          0        0        0  108.278  104.838  109.345  108.366  102.751  109.755  106.073  111.588        0
>  16          0        0        0  126.576  137.928  135.077  127.398  128.640  116.650  118.919   81.052        0
>  17          0        0        0  136.214  155.006  150.075  152.893  142.576  139.754  123.273  135.333        0
>  18          0        0        0  106.082  117.189  110.276  108.437  102.654  102.009  108.063   83.891        0
>  19          0        0        0  126.968  123.477  122.507  130.529  121.631  112.761  107.276   69.136        0
>  20          0        0        0  123.571  122.066  119.333  112.983  114.258  101.239  104.946   76.340        0
>  21          0        0        0  119.848  130.510  116.954  120.328  136.133  108.740  129.179  136.142        0
>  22          0        0        0  125.456  131.996   85.176  121.730  109.325   97.497  123.128  111.963        0
>  23          0        0        0  135.516  128.314  129.563  129.181  128.466  100.402  131.383  136.804        0
>  24          0        0        0  148.435  130.031  140.443  134.428  134.884  147.266  121.692  130.591        0
>  25          0        0        0        0        0        0        0        0        0        0        0        0''',


    'metze lmdb': '''
 r\S         1        2        3        4        5        6        7        8        9       10       11       12
  1          0        0        0        0        0        0        0        0        0        0        0        0
  2          0        0        0        0        0        0        0        0        0        0        0        0
  3          0        0        0        0        0        0        0        0        0        0        0        0
  4          0        0        0   41.500   49.920   60.505   71.904   82.306   88.818   92.108   97.737        0
  5          0        0        0   50.826   61.666   73.555   78.560   85.326   96.618  105.643  105.788        0
  6          0        0        0   61.690   77.126   83.261   90.495  101.572  101.589   95.307  104.340        0
  7          0        0        0   75.903   66.315   91.912  102.188  107.380  112.907  102.057  105.927        0
  8          0        0        0   79.314   91.225   92.837  100.272  103.324  114.537  107.632   95.885        0
  9          0        0        0   88.732  106.105  108.062  106.598  102.846  109.440  105.508  103.133        0
 10          0        0        0  105.399  112.790  118.182  122.781  120.032  124.794  118.779  106.048        0
 11          0        0        0  106.506  107.404  101.974   95.843  106.068  107.123  116.111   93.920        0
 12          0        0        0  102.183  112.785  111.602  120.868  125.455  123.573  114.574  122.658        0
 13          0        0        0  118.938  107.596   80.075  119.019  114.389  116.111  113.056  116.987        0
 14          0        0        0  104.792  100.931   19.004  110.423  124.053  101.810  117.015  124.960        0
 15          0        0        0  121.707  109.724  113.472  124.921  127.075  117.865  120.893  107.083        0
 16          0        0        0  140.172  141.961  132.248  141.295  140.722  144.381  136.247  132.452        0
 17          0        0        0  160.095  155.573  165.428  162.899  144.628  155.613  150.818  133.884        0
 18          0        0        0  122.939  104.896  114.760  126.131  116.288  120.794  122.241  117.317        0
 19          0        0        0  127.706  125.558  139.885  134.078  137.301  136.676  124.412  123.001        0
 20          0        0        0  130.321  135.464  144.009  126.692  147.900  133.300  120.658  115.100        0
 21          0        0        0  131.667  122.350  135.096  146.961  154.367  149.734  128.683  131.608        0
 22          0        0        0  144.664  136.841  129.199  142.176  153.926  141.172  122.289  113.799        0
 23          0        0        0  146.478  149.614  138.653  145.362  141.415  141.297  123.970  107.634        0
 24          0        0        0  154.778  142.671  151.207  164.910  167.014  164.177  153.324  122.174        0
 25          0        0        0        0        0        0        0        0        0        0        0        0
    ''',
    'tim pso v2': """
 r\S         1        2        3        4        5        6        7        8        9       10       11       12
  1          0        0        0        0        0        0        0        0        0        0        0        0
  2          0        0        0        0        0        0        0        0        0        0        0        0
  3          0        0        0        0        0        0        0        0        0        0        0        0
  4          0        0        0   37.082   44.801   60.532   75.801   78.271   85.944   94.047   72.176        0
  5          0        0        0   51.301   53.488   69.328   88.031   88.716  102.762   85.978  105.050        0
  6          0        0        0   64.065   75.319   82.956   78.176   87.288   97.091  102.148   94.212        0
  7          0        0        0   80.730   86.159   63.797  104.860   92.028   94.112   95.093   99.183        0
  8          0        0        0   69.466   92.338  100.678  105.719  103.304  106.430  100.039  120.579        0
  9          0        0        0   74.105   96.505  102.198  105.541  101.393  105.277  105.227   99.546        0
 10          0        0        0   82.970  105.056  104.515  112.601  111.285  102.560  125.895   84.467        0
 11          0        0        0   82.960   94.571  121.788  107.127  114.524  108.854   86.997   94.095        0
 12          0        0        0  107.628  108.813  104.073  107.400  112.092  108.973  111.526  130.635        0
 13          0        0        0  106.603  116.545  133.409  108.048  120.586  118.293  106.397  114.992        0
 14          0        0        0   92.186  125.236  114.379  116.258  108.284  126.504  121.857  109.804        0
 15          0        0        0  121.878   91.061  119.415  119.071  137.940  125.527  125.222  116.084        0
 16          0        0        0  110.470  124.373  128.996  127.525  122.629  114.367  128.881  104.336        0
 17          0        0        0  102.250  121.519  124.631  110.705  120.954  123.130  120.790  105.637        0
 18          0        0        0  113.602  122.945  145.161  129.442  109.787  124.186  128.351   88.409        0
 19          0        0        0  114.550  128.081  130.861  115.099  113.682  132.216  106.412  127.463        0
 20          0        0        0  123.626  144.265  135.671  114.912  108.446  133.620  122.962  107.425        0
 21          0        0        0  121.589  129.178  127.850  134.807  130.465  119.445  104.781  100.038        0
 22          0        0        0  118.867  131.164  132.138  132.204  143.113  132.713  113.063   78.803        0
 23          0        0        0  112.510  138.238  125.054  118.633  144.708  125.383  113.182   95.404        0
 24          0        0        0  130.914  131.791  132.258  159.547  151.920  131.703  123.747  101.755        0
 25          0        0        0        0        0        0        0        0        0        0        0        0
    """,
    'tim pso v1': """
>>>>  r\S         1        2        3        4        5        6        7        8        9       10       11       12
>>>>   1          0        0        0        0        0        0        0        0        0        0        0        0
>>>>   2          0        0        0        0        0        0        0        0        0        0        0        0
>>>>   3          0        0        0        0        0        0        0        0        0        0        0        0
>>>>   4          0        0        0   37.640   55.192   52.049   66.739   63.518   69.398   86.641   82.049        0
>>>>   5          0        0        0   48.047   60.055   70.487   74.940   72.498   70.202   97.947   99.643        0
>>>>   6          0        0        0   55.140   70.333   82.655   84.441   92.260   80.312  115.030   99.515        0
>>>>   7          0        0        0   74.438   86.893   97.487  100.616   98.608   71.773   86.354  109.202        0
>>>>   8          0        0        0   78.898   92.836  111.368   99.777   98.944   89.442   96.071   78.242        0
>>>>   9          0        0        0   87.470   94.161  110.414  105.972  115.760   90.316   85.671   86.597        0
>>>>  10          0        0        0   87.434   55.924  114.116  104.419  110.603   94.349  108.116  113.633        0
>>>>  11          0        0        0   96.583  111.139   91.252  115.436  110.977   93.257   94.942  111.828        0
>>>>  12          0        0        0  105.925  114.167  116.194  124.681  118.198  102.879  120.741  102.004        0
>>>>  13          0        0        0  108.270  115.788  115.467   99.385  120.024  113.897  111.195  128.231        0
>>>>  14          0        0        0  102.137  121.884  109.046  135.819  111.838   94.954  110.020  118.498        0
>>>>  15          0        0        0  127.509  136.431  126.744  114.100  121.091  113.135  120.402  114.367        0
>>>>  16          0        0        0  120.966  141.463  123.091  121.224  116.167  113.556  106.194  113.421        0
>>>>  17          0        0        0  132.528  124.961  117.453  120.241  119.962  109.551  143.465  118.850        0
>>>>  18          0        0        0  103.470  101.866  114.524  115.130  126.133   60.263  126.443  107.731        0
>>>>  19          0        0        0  121.166  122.071  139.726  127.497  144.423  118.111  127.632  125.059        0
>>>>  20          0        0        0  135.826  135.446  144.073  120.870  137.250  112.885  123.047   90.222        0
>>>>  21          0        0        0  131.822  123.537  134.439  134.838  138.547  127.177  109.355   94.261        0
>>>>  22          0        0        0  130.700  126.817  117.283 *160.052  153.121  133.673  100.860  112.662        0
>>>>  23          0        0        0  125.088  130.050  148.148  143.235  127.453  119.559   99.157   97.740        0
>>>>  24          0        0        0  120.754  129.787  141.368  131.238  129.614  126.973  120.354   94.506        0
>>>>  25          0        0        0        0        0        0        0        0        0        0        0        0
    """,
    'pre-pso': """
>>>>  r\S         1        2        3        4        5        6        7        8        9       10       11       12
>>>>   1          0        0        0        0        0        0        0        0        0        0        0        0
>>>>   2          0        0        0        0        0        0        0        0        0        0        0        0
>>>>   3          0        0        0        0        0        0        0        0        0        0        0        0
>>>>   4          0        0        0   41.119   56.732   66.447   72.572   76.956   95.436  102.396  110.454        0
>>>>   5          0        0        0   49.145   70.014   74.849   84.013   89.707  107.108  116.287  103.106        0
>>>>   6          0        0        0   68.731   78.698   93.159   95.705  115.973  114.349  112.678  130.282        0
>>>>   7          0        0        0   71.490   85.902  108.542  108.586  113.590  126.788  119.140  101.968        0
>>>>   8          0        0        0   84.228  103.297  112.420  108.141  112.146  125.492  109.455  101.155        0
>>>>   9          0        0        0   88.669  111.279  121.480  121.692  138.248  115.464  131.850   98.632        0
>>>>  10          0        0        0  107.833  115.134  126.926  132.568  116.088  136.371   97.090  126.787        0
>>>>  11          0        0        0  114.108  111.883  126.213  139.040  141.352  106.134  124.904  118.583        0
>>>>  12          0        0        0  109.988  120.804  142.387  133.999  124.241  131.333  107.382  111.447        0
>>>>  13          0        0        0  133.787  115.635  135.760  144.311  113.029  109.257  124.848  135.680        0
>>>>  14          0        0        0  142.868  118.900  139.201  131.333  132.071  113.330  116.351  118.728        0
>>>>  15          0        0        0  124.355  132.024  146.237  130.092  107.181  125.418  121.196  126.104        0
>>>>  16          0        0        0  123.211  140.214  135.858  109.205  146.865  137.027  111.136  121.051        0
>>>>  17          0        0        0  120.864  149.945  116.799  147.768  119.295  126.733  119.915  107.164        0
>>>>  18          0        0        0  140.311  138.099  108.622  126.043  127.352  143.128  134.762   93.017        0
>>>>  19          0        0        0  145.346  133.715  120.586  139.703  120.015  118.425   83.349  106.214        0
>>>>  20          0        0        0  144.652  130.634  110.613  123.414  151.610  135.753   93.042   85.515        0
>>>>  21          0        0        0  131.350  122.082  121.926  146.542  132.719  126.720  120.016   91.363        0
>>>>  22          0        0        0  140.259  146.325  129.648  142.637  142.712  132.569  124.193   84.189        0
>>>>  23          0        0        0 *169.764  139.553   91.046  137.663  159.753  138.276  102.191  110.595        0
>>>>  24          0        0        0  148.510  142.059  141.010  137.082   98.231   96.259  109.009   69.462        0
>>>>  25          0        0        0        0        0        0        0        0        0        0        0        0
    """,
    'windows': """
>>>> r\S        1        2        3        4        5        6        7        8        9       10       11       12
>>>>  1         0        0        0        0        0        0        0        0        0        0        0        0
>>>>  2         0        0        0        0        0        0        0        0        0        0        0        0
>>>>  3         0        0        0        0        0        0        0        0        0        0        0        0
>>>>  4         0        0        0   37.499   51.081   47.946   78.658   73.416   92.505   95.842  100.820        0
>>>>  5         0        0        0   55.603   57.470   74.442   86.191  113.089  111.861  115.396  142.818        0
>>>>  6         0        0        0   58.732   85.243   92.833  102.397  108.455  136.802  134.110  136.791        0
>>>>  7         0        0        0   66.669   91.372  100.347  132.541  159.121  137.524  166.432  131.660        0
>>>>  8         0        0        0   76.959  113.768  130.787  148.635  140.318  155.053  185.398  172.079        0
>>>>  9         0        0        0  104.442  124.219  135.548  156.073  159.233  161.505  165.132  111.609        0
>>>> 10         0        0        0  121.444  128.814  170.306  172.741  173.592  155.078  137.541  160.373        0
>>>> 11         0        0        0  119.806  147.530  171.919  175.189  156.816  189.379  176.344  155.873        0
>>>> 12         0        0        0  103.682  145.108  174.202  172.044  206.165  129.995  157.405  150.218        0
>>>> 13         0        0        0  151.011  151.274  172.072  189.949  161.779  176.042  137.990  140.948        0
>>>> 14         0        0        0  146.589  166.755  213.144  189.248  166.505  145.031  138.344  150.909        0
>>>> 15         0        0        0  149.442  190.469  200.051  160.482  143.324  151.437  141.908  130.576        0
>>>> 16         0        0        0  173.891  202.137  204.066  172.500  176.371  166.698  127.024  141.724        0
>>>> 17         0        0        0  170.829  180.184  196.766  181.791  147.663  155.474   99.551  127.230        0
>>>> 18         0        0        0  188.009  191.858  155.009  172.549  147.957  152.508  124.296  129.689        0
>>>> 19         0        0        0  201.694  225.261  190.230  157.619  152.969  136.545  130.671  125.775        0
>>>> 20         0        0        0  203.151  209.354  165.844  166.927  141.296  140.057  139.265  125.006        0
>>>> 21         0        0        0  212.496  217.526  171.679  168.568  168.101  145.787  111.281  106.252        0
>>>> 22         0        0        0  184.216 *235.421  180.842  156.551  158.798  149.434  115.148  113.642        0
>>>> 23         0        0        0  201.699  210.266  191.049  153.199  153.461  110.562  110.072  112.646        0
>>>> 24         0        0        0  222.205  150.690  155.598  176.060  137.402  123.665  115.973  106.362        0
>>>> 25         0        0        0        0        0        0        0        0        0        0        0        0
    """
}

def parse_string(s):
    rows = []
    row_h = []
    column_h = None
    lines = s.split('\n')
    for line in lines:
        line = line.lstrip('>')
        line = line.strip()
        if not line:
            continue
        row = line.split()
        h = row.pop(0)
        if h == r'r\S':
            column_h = row
        else:
            row_h.append(h)
            rows.append([float(x.replace('*', '')) for x in row])

    return row_h, column_h, rows


PATTERNS = itertools.cycle(('#%s%%02x%%02x', '#%%02x%%02x%s', '#%%02x%s%%02x'))
LINESTYLES = itertools.cycle((':', '--'))

def get_colourer(k):
    h = sha1(k).hexdigest()
    pattern = next(PATTERNS) % h[:2]
    linestyle = next(LINESTYLES)
    def f(i):
        c = (i * 11) % 256
        return pattern % (c, 255 - c)
    return linestyle, f


def main():
    #datasets = ('metze lmdb', 'tim pso v2')
    #datasets = ('metze lmdb', 'master random-seed=1 v2')
    #datasets = ('master random-seed=1 v1', 'master random-seed=1 v2')
    datasets = ('windows random-seed=1', 'master random-seed=1 v2')
    ax = plt.axes()
    for k, v in results.items():
        if k not in datasets:
            continue

        linestyle, colourer = get_colourer(k)

        row_h, col_h, data = parse_string(v)
        labelbbox={
            'facecolor': colourer(1),
            'color': colourer(1),
            #'edgecolor': 'none',
            'linewidth':1.5,
            'zorder':9,
            #'hatch': 'x',
            'fill': False,
        }
        col_max = [(0, 0, 0)] * len(data[0])

        rows = []
        for rh, row in zip(row_h, data):
            ly = max(row)
            lx = row.index(ly)
            if ly > col_max[lx][1]:
                label = '%s r%s/s%s: %.1f' % (k, rh, lx, ly)
                col_max[lx] = (lx, ly, label)

            rows.append([x if x else None for x in row])

        d = np.array(rows)
        for i, row in enumerate(d.T):
            ax.plot([None] + list(row), linestyle, color=colourer(i))
            if row[3] is not None:
                ax.text(3, row[3], "S=%d" % (i + 1), color=colourer(i), fontsize=10)

        for lx, ly, label in col_max:
            if ly == 0:
                continue


    ax.set_xlabel('r')
    #ax.set_ylabel('time (seconds)')

    plt.show()

    for d in datasets:
        fig, ax = plt.subplots()
        rh, ch, data = parse_string(results[d])
        ax.set_title(d)
        ax.set_xlabel('S')
        ax.set_ylabel('r')
        im = ax.imshow(data)
        fig.tight_layout()
        plt.show()


    rh, ch, v1 = parse_string(results[datasets[0]])
    rh, ch, v2 = parse_string(results[datasets[1]])
    fig, ax = plt.subplots()
    w = np.array(v1)
    t = np.array(v2)
    w[:4,:] = 0.1
    w[24:,:] = 0.1
    w[:,:4] = 0.1
    w[:,11:] = 0.1
    t[:4,:] = 0.1
    t[24:,:] = 0.1
    t[:,:4] = 0.1
    t[:,11:] = 0.1

    #w = np.array(v1)[4:24, 4:11]
    #t = np.array(v2)[4:24, 4:11]

    #im = ax.imshow(windows)
    #fig.tight_layout()
    im = ax.imshow(np.abs((w - t) / t))
    fig.tight_layout()
    plt.show()


    ax = plt.axes()
    wt = np.array(v1).T
    tt = np.array(v2).T

    i = 0
    for wr, tr in zip(wt, tt):
        row = []
        for wv, tv in zip(wr, tr):
            if tv:
                row.append((wv - tv) / tv)
            else:
                row.append(None)
        colour = '#af%02x%02x' % ((i * 17) & 255, 255 - (i * 13) & 255)
        ax.plot(row, '-', color=colour)
        if row[3]:
            ax.text(1.6, row[3], "S=%d" % (i + 1), color=colour, fontsize=10)
        i += 1
    plt.show()


main()
