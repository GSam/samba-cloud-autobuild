#!/usr/bin/python
user_attrs = set(["msSFU30NisDomain", "msSFU30Name",
                  "msDS-SourceObjectDN", "x500uniqueIdentifier",
                  "userSMIMECertificate", "userPKCS12", "uid",
                  "secretary", "roomNumber", "preferredLanguage",
                  "photo", "labeledURI", "jpegPhoto",
                  "homePostalAddress", "givenName", "employeeType",
                  "employeeNumber", "displayName", "departmentNumber",
                  "carLicense", "audio", "msTSPrimaryDesktop",
                  "msTSSecondaryDesktops",
                  "msPKI-CredentialRoamingTokens",
                  "msDS-ResultantPSO", "msTSLSProperty01",
                  "msTSLSProperty02", "msTSManagingLS2",
                  "msTSManagingLS3", "msTSManagingLS4",
                  "msTSLicenseVersion2", "msTSLicenseVersion3",
                  "msTSLicenseVersion4", "msTSExpireDate2",
                  "msTSExpireDate3", "msTSExpireDate4",
                  "msDS-AuthenticatedAtDC",
                  "msDS-UserPasswordExpiryTimeComputed",
                  "msTSManagingLS", "msTSLicenseVersion",
                  "msTSExpireDate", "msTSProperty02",
                  "msTSProperty01", "msTSInitialProgram",
                  "msTSWorkDirectory", "msTSDefaultToMainPrinter",
                  "msTSConnectPrinterDrives",
                  "msTSConnectClientDrives",
                  "msTSBrokenConnectionAction",
                  "msTSReconnectionAction", "msTSMaxIdleTime",
                  "msTSMaxConnectionTime", "msTSMaxDisconnectionTime",
                  "msTSRemoteControl", "msTSAllowLogon",
                  "msTSHomeDrive", "msTSHomeDirectory",
                  "msTSProfilePath",
                  "msDS-FailedInteractiveLogonCountAtLastSuccessfulLogon",
                  "msDS-FailedInteractiveLogonCount",
                  "msDS-LastFailedInteractiveLogonTime",
                  "msDS-LastSuccessfulInteractiveLogonTime",
                  "msRADIUS-SavedFramedIpv6Route",
                  "msRADIUS-FramedIpv6Route",
                  "msRADIUS-SavedFramedIpv6Prefix",
                  "msRADIUS-FramedIpv6Prefix",
                  "msRADIUS-SavedFramedInterfaceId",
                  "msRADIUS-FramedInterfaceId",
                  "msPKIAccountCredentials", "msPKIDPAPIMasterKeys",
                  "msPKIRoamingTimeStamp",
                  "msDS-SupportedEncryptionTypes",
                  "msDS-SecondaryKrbTgtNumber", "pager", "o",
                  "mobile", "manager", "mail", "initials",
                  "homePhone", "businessCategory", "userCertificate",
                  "userWorkstations", "userSharedFolderOther",
                  "userSharedFolder", "userPrincipalName",
                  "userParameters", "userAccountControl",
                  "unicodePwd", "terminalServer",
                  "servicePrincipalName", "scriptPath", "pwdLastSet",
                  "profilePath", "primaryGroupID", "preferredOU",
                  "otherLoginWorkstations", "operatorCount",
                  "ntPwdHistory", "networkAddress",
                  "msRASSavedFramedRoute",
                  "msRASSavedFramedIPAddress",
                  "msRASSavedCallbackNumber", "msRADIUSServiceType",
                  "msRADIUSFramedRoute", "msRADIUSFramedIPAddress",
                  "msRADIUSCallbackNumber",
                  "msNPSavedCallingStationID", "msNPCallingStationID",
                  "msNPAllowDialin", "mSMQSignCertificatesMig",
                  "mSMQSignCertificates", "mSMQDigestsMig",
                  "mSMQDigests", "msIIS-FTPRoot", "msIIS-FTPDir",
                  "msDS-User-Account-Control-Computed",
                  "msDS-Site-Affinity", "mS-DS-CreatorSID",
                  "msDS-Cached-Membership-Time-Stamp",
                  "msDS-Cached-Membership",
                  "msDRM-IdentityCertificate",
                  "msCOM-UserPartitionSetLink", "maxStorage",
                  "logonWorkstation", "logonHours", "logonCount",
                  "lockoutTime", "localeID", "lmPwdHistory",
                  "lastLogonTimestamp", "lastLogon", "lastLogoff",
                  "homeDrive", "homeDirectory", "groupsToIgnore",
                  "groupPriority", "groupMembershipSAM",
                  "dynamicLDAPServer", "desktopProfile",
                  "defaultClassStore", "dBCSPwd",
                  "controlAccessRights", "codePage", "badPwdCount",
                  "badPasswordTime", "adminCount", "aCSPolicyName",
                  "accountExpires", "msDS-HABSeniorityIndex",
                  "msDS-PhoneticDisplayName",
                  "msDS-PhoneticCompanyName",
                  "msDS-PhoneticDepartment", "msDS-PhoneticLastName",
                  "msDS-PhoneticFirstName", "houseIdentifier",
                  "msExchHouseIdentifier", "homePostalAddress",
                  "x121Address", "comment", "title", "co",
                  "primaryTelexNumber", "telexNumber",
                  "teletexTerminalIdentifier", "street", "st",
                  "registeredAddress", "preferredDeliveryMethod",
                  "postalCode", "postalAddress", "postOfficeBox",
                  "thumbnailPhoto", "physicalDeliveryOfficeName",
                  "pager", "otherPager", "otherTelephone", "mobile",
                  "otherMobile", "primaryInternationalISDNNumber",
                  "ipPhone", "otherIpPhone", "otherHomePhone",
                  "homePhone", "otherFacsimileTelephoneNumber",
                  "personalTitle", "middleName", "otherMailbox", "ou",
                  "o", "mhsORAddress", "msDS-AllowedToDelegateTo",
                  "manager", "thumbnailLogo", "l",
                  "internationalISDNNumber", "initials", "givenName",
                  "generationQualifier", "facsimileTelephoneNumber",
                  "employeeID", "mail", "division",
                  "destinationIndicator", "department", "c",
                  "countryCode", "company", "assistant",
                  "streetAddress", "attributeCertificateAttribute",
                  "userPassword", "telephoneNumber", "sn",
                  "serialNumber", "seeAlso", "objectClass",
                  "objectCategory", "nTSecurityDescriptor",
                  "instanceType""msSFU30PosixMemberOf",
                  "msDFSR-ComputerReferenceBL",
                  "msDFSR-MemberReferenceBL",
                  "msDS-ObjectReferenceBL", "msDS-EnabledFeatureBL",
                  "msDS-LastKnownRDN", "msDS-HostServiceAccountBL",
                  "msDS-OIDToGroupLinkBl",
                  "msDS-LocalEffectiveRecycleTime",
                  "msDS-LocalEffectiveDeletionTime", "isRecycled",
                  "msDS-NcType", "msDS-PSOApplied",
                  "msDS-PrincipalName", "msDS-RevealedListBL",
                  "msDS-AuthenticatedToAccountlist",
                  "msDS-IsPartialReplicaFor", "msDS-IsDomainFor",
                  "msDS-IsFullReplicaFor", "msDS-RevealedDSAs",
                  "msDS-KrbTgtLinkBl", "url", "wWWHomePage",
                  "whenCreated", "whenChanged", "wellKnownObjects",
                  "wbemPath", "uSNSource", "uSNLastObjRem",
                  "USNIntersite", "uSNDSALastObjRemoved",
                  "uSNCreated", "uSNChanged", "systemFlags",
                  "subSchemaSubEntry", "subRefs",
                  "structuralObjectClass", "siteObjectBL",
                  "serverReferenceBL", "sDRightsEffective",
                  "revision", "repsTo", "repsFrom", "directReports",
                  "replUpToDateVector", "replPropertyMetaData",
                  "name", "queryPolicyBL", "proxyAddresses",
                  "proxiedObjectName", "possibleInferiors",
                  "partialAttributeSet",
                  "partialAttributeDeletionList",
                  "otherWellKnownObjects", "objectVersion",
                  "objectGUID", "distinguishedName",
                  "nonSecurityMemberBL", "netbootSCPBL", "ownerBL",
                  "msDS-ReplValueMetaData",
                  "msDS-ReplAttributeMetaData", "msDS-NonMembersBL",
                  "msDS-NCReplOutboundNeighbors",
                  "msDS-NCReplInboundNeighbors", "msDS-NCReplCursors",
                  "msDS-TasksForAzRoleBL", "msDS-TasksForAzTaskBL",
                  "msDS-OperationsForAzRoleBL",
                  "msDS-OperationsForAzTaskBL",
                  "msDS-MembersForAzRoleBL", "msDs-masteredBy",
                  "mS-DS-ConsistencyGuid",
                  "mS-DS-ConsistencyChildCount",
                  "msDS-Approx-Immed-Subordinates",
                  "msCOM-PartitionSetLink", "msCOM-UserLink",
                  "modifyTimeStamp", "masteredBy", "managedObjects",
                  "lastKnownParent", "isPrivilegeHolder", "memberOf",
                  "isDeleted", "isCriticalSystemObject",
                  "showInAdvancedViewOnly", "fSMORoleOwner",
                  "fRSMemberReferenceBL", "frsComputerReferenceBL",
                  "fromEntry", "flags", "extensionName",
                  "dSASignature", "dSCorePropagationData",
                  "displayNamePrintable", "displayName",
                  "description", "createTimeStamp", "cn",
                  "canonicalName", "bridgeheadServerListBL",
                  "allowedChildClassesEffective",
                  "allowedChildClasses", "allowedAttributesEffective",
                  "allowedAttributes", "adminDisplayName",
                  "adminDescription",
                  "msDS-NC-RO-Replica-Locations-BL"])


f = open ('../samba/source4/setup/ad-schema/MS-AD_Schema_2K8_R2_Attributes.txt')

key = None

for line in f:
    line = line.strip()    
    if line.startswith('ldapDisplayName: '):
        key = line.split()[1]
    elif line.startswith('attributeSyntax: '):
        syntax = line.split()[1]
        if key in user_attrs:
            print key, syntax
